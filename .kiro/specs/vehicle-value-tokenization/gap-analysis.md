# ギャップ分析: 車両価値トークン化機能（車担保自動ローン）

## 1. 分析概要

### スコープ
車両の査定価値を担保として自動ローンを提供し、ウォレット残高不足時の自動借入と収益からの自動返済を実現する機能の実装ギャップを分析。

### 主要な発見
- **既存資産**: Base L2ブロックチェーン、Hardhat開発環境、Next.jsフロントエンド基盤
- **依存機能**: ウォレットアドレス変換機能（ERC4337 SmartAccount）
- **主要なギャップ**: 車両査定API、ローン管理スマートコントラクト、自動借入・返済ロジック、金利計算エンジン、車両情報DBが未実装
- **実装アプローチ**: 新規コンポーネント作成中心、スマートコントラクト重視のアーキテクチャ

### 推奨事項
設計フェーズで以下を重点的に検討：
1. 車両査定方法（外部API選定 or AI自前実装）
2. ローン契約スマートコントラクト設計（貸付・返済・金利計算の完全オンチェーン化）
3. 自動借入トリガー設計（ERC4337 Paymasterパターン vs カスタムロジック）
4. 金利計算の正確性とガスコスト最適化

---

## 2. 現状調査

### 2.1 既存のドメイン関連資産

#### スマートコントラクト基盤
**ファイル**: `pkgs/contract/`
- Hardhat開発環境
- Base Sepolia設定
- OpenZeppelin Contracts導入済み

**再利用可能な要素**:
- コントラクトコンパイル・テスト環境
- Base Sepoliaデプロイスクリプト
- Hardhat Ignitionデプロイシステム

**ギャップ**:
- ❌ ローン管理コントラクト
- ❌ 自動借入・返済ロジック
- ❌ 金利計算コントラクト
- ❌ 車両レジストリコントラクト

#### フロントエンド基盤
**ファイル**: `pkgs/frontend/`
- Next.js 16 (App Router)
- React 19
- PWA対応

**再利用可能な要素**:
- ビルドパイプライン
- UIコンポーネントライブラリ（shadcn/ui）
- PWA通知機能

**ギャップ**:
- ❌ Web3統合（wagmi/viem）（tipping-featureと共通）
- ❌ 車両情報入力フォーム
- ❌ ローン状態ダッシュボード
- ❌ 査定結果表示UI

#### 依存機能（未実装）
**必須依存**:
1. **ウォレットアドレス変換機能**（wallet-address-conversion）
   - ERC4337 SmartAccount作成
   - 現状: 完全未実装

**影響**: SmartAccountが存在しないとローン契約の紐付け不可

### 2.2 既存のアーキテクチャパターン

#### モノレポ構造
- 新規パッケージ追加容易（`pkgs/contract/contracts/LoanManager.sol` 等）

#### スマートコントラクトパターン
- Solidity 0.8.20+
- OpenZeppelin Contractsライブラリ活用
- Hardhat Ignitionデプロイ

#### API設計パターン
- `/api/`: Laravel（予定）
- `/papi/`: Flask（予定）

### 2.3 統合ポイント

#### データモデル（未定義）
```typescript
// 車両情報
interface VehicleData {
  plateNumber: string;       // ナンバープレート
  manufacturer: string;      // メーカー
  model: string;             // 車種
  year: number;              // 年式
  mileage: number;           // 走行距離（km）
  registeredAt: Date;        // 登録日時
}

// 査定結果
interface AppraisalResult {
  appraisalAmount: number;   // 査定額（円 or USDC）
  appraisalDate: Date;       // 査定日時
  expiryDate: Date;          // 有効期限（30日後）
  appraiser: string;         // 査定者（API名 or AI）
}

// ローン状態
interface LoanStatus {
  creditLimit: number;       // 利用可能枠（査定額の75%）
  borrowed: number;          // 借入額
  repaid: number;            // 返済額
  balance: number;           // 現在の借入残高
  interestRate: number;      // 金利（年率%）
  managementFee: number;     // 月額管理手数料
  lastUpdated: Date;         // 最終更新日時
}
```

#### スマートコントラクト設計（未定義）
```solidity
// ローン管理コントラクト
contract LoanManager {
  struct Vehicle {
    bytes32 plateHash;        // ナンバープレートハッシュ
    uint256 appraisalAmount;  // 査定額
    uint256 appraisalExpiry;  // 査定有効期限
    uint256 creditLimit;      // 利用可能枠
  }

  struct Loan {
    address borrower;         // 借り手（SmartAccount）
    uint256 borrowed;         // 借入額
    uint256 interestRate;     // 金利
    uint256 lastInterestUpdate; // 最終金利更新
  }

  mapping(address => Vehicle) public vehicles;
  mapping(address => Loan) public loans;

  function registerVehicle(...) external;
  function autoBorrow(uint256 amount) external;
  function autoRepay(uint256 amount) external;
  function calculateInterest(address borrower) public view returns (uint256);
}
```

---

## 3. 要件実現可能性分析

### 3.1 技術要件とギャップ

#### 要件1: 車両情報の登録

**必要な機能**:
- 車両情報入力フォーム
- ナンバープレート検証（既存登録チェック）
- ウォレットアドレス紐付け検証
- オンチェーン記録

**既存資産**:
- ✅ Next.js（UIフレームワーク）
- ✅ Hardhat（スマートコントラクト）

**ギャップ**:
- ❌ Vehicle_Registry コンポーネント（フロントエンド）
- ❌ VehicleRegistry スマートコントラクト
- ❌ 車両情報DB（Laravel）
- ❌ **依存**: wallet-address-conversion機能

**複雑度シグナル**: 低〜中（標準的なフォーム + CRUD + コントラクト）

**制約**: ウォレットアドレス変換機能が未完成のため実装開始に制約

#### 要件2: レンタカー・カーシェアナンバーの除外

**必要な機能**:
- ひらがな「わ」「れ」検出
- 登録拒否ロジック

**既存資産**:
- ❌ なし

**ギャップ**:
- ❌ Rental_Plate_Filter 実装（フロントエンド + コントラクト）
- ❌ 正規表現パターン

**複雑度シグナル**: 低（簡単なバリデーション）

#### 要件3: 車両査定

**必要な機能**:
- AI/外部APIによる車両市場価値査定
- 査定結果保存（オンチェーン + オフチェーン）
- 査定有効期限管理（30日）

**既存資産**:
- ❌ なし

**ギャップ**:
- ❌ 車両査定API選定・統合
  - 外部API（カーセンサー、グーネット等）
  - AI査定モデル（自前実装 or サービス利用）
- ❌ Appraisal_Service 実装（Flask）
- ❌ 査定結果保存コントラクト

**複雑度シグナル**: 中〜高（外部API連携 or AI実装、精度・コスト考慮）

**研究必要**:
- 車両査定API調査（利用可能API、料金、精度）
- AI査定モデル（学習データ、実現可能性）
- ハイブリッド戦略（外部API + AI補正）

#### 要件4: 利用可能枠の計算

**必要な機能**:
- 査定額の75%計算
- 既存借入残高考慮

**既存資産**:
- ❌ なし

**ギャップ**:
- ❌ Credit_Calculator 実装（スマートコントラクト or フロントエンド）

**複雑度シグナル**: 低（簡単な計算処理）

#### 要件5: ローン契約の作成

**必要な機能**:
- オンチェーンローン契約
- 利用可能枠、金利、管理手数料記録
- ERC4337 SmartAccount連携

**既存資産**:
- ✅ Hardhat開発環境
- ✅ Base Sepolia設定

**ギャップ**:
- ❌ Loan_Contract スマートコントラクト
- ❌ ERC4337 SmartAccount統合（**依存**: wallet-address-conversion）
- ❌ 契約作成UI

**複雑度シグナル**: 中〜高（スマートコントラクト設計、セキュリティ考慮）

**研究必要**: 
- ローン契約の完全オンチェーン化 vs ハイブリッド（一部オフチェーン）
- 金利計算の正確性とガスコスト

#### 要件6: 自動借入

**必要な機能**:
- 残高不足検知
- 利用可能枠チェック
- 自動借入実行
- イベント発行

**既存資産**:
- ❌ なし

**ギャップ**:
- ❌ Auto_Borrow_Handler 実装（スマートコントラクト）
- ❌ 残高監視ロジック
  - オプションA: ERC4337 Paymasterパターン（ガス代支払い時に自動借入）
  - オプションB: トランザクション前チェック（フロントエンド）
- ❌ 通知システム（tipping-featureと共通）

**複雑度シグナル**: 高（自動化ロジック、タイミング制御）

**研究必要**:
- ERC4337 Paymasterでの自動借入実現可能性
- ガスコスト最適化

#### 要件7: 自動返済

**必要な機能**:
- 入金検知
- 返済割合設定（デフォルト50%）
- 自動返済実行
- イベント発行

**既存資産**:
- ❌ なし

**ギャップ**:
- ❌ Auto_Repay_Handler 実装（スマートコントラクト）
- ❌ 入金監視ロジック
  - オプションA: コントラクトの`receive()`関数（自動実行）
  - オプションB: 定期バッチ処理
- ❌ 返済設定UI

**複雑度シグナル**: 中〜高（自動化ロジック、入金ソース識別）

**研究必要**:
- 入金ソース識別方法（データ収益 vs 投げ銭 vs その他）
- 完全自動 vs ユーザー承認

#### 要件8: 金利と手数料の計算

**必要な機能**:
- 年率3-5%の日割り計算
- 月額500円管理手数料
- 借入残高への加算

**既存資産**:
- ❌ なし

**ギャップ**:
- ❌ 金利計算エンジン（スマートコントラクト）
- ❌ 日割り金利の正確な計算（Solidityの制約）
- ❌ 手数料徴収ロジック

**複雑度シグナル**: 中（金利計算の正確性、Solidity制約）

**研究必要**:
- Solidity浮動小数点演算（固定小数点ライブラリ）
- 日割り金利の精度とガスコスト

#### 要件9: リアルタイム残高・ローン状態表示

**必要な機能**:
- ウォレット残高、借入残高、利用可能枠表示
- 査定額、査定有効期限表示
- 金利・手数料内訳表示

**既存資産**:
- ✅ Next.js（UIフレームワーク）

**ギャップ**:
- ❌ ダッシュボードUI
- ❌ Web3統合（wagmi/viemでコントラクト読み取り）
- ❌ リアルタイム更新（WebSocket or ポーリング）

**複雑度シグナル**: 低〜中（標準的なダッシュボードUI）

#### 要件10: 通知機能

**必要な機能**:
- 自動借入・返済通知
- 査定期限警告（残り7日）
- 利用枠80%警告
- 完済通知

**既存資産**:
- ✅ PWA基盤（next-pwa）
- ✅ Service Worker

**ギャップ**:
- ❌ Web Push Protocol実装（**共通**: tipping-featureと統合可能）
- ❌ 通知トリガー設定

**複雑度シグナル**: 中（tipping-featureと共通実装で効率化可能）

#### 要件11: セキュリティとプライバシー

**必要な機能**:
- 車両情報ハッシュ化
- ローン情報暗号化
- アクセス制御（所有者のみ）
- 不正操作防止

**既存資産**:
- ✅ Solidityのアクセス制御パターン（OpenZeppelin Ownable等）

**ギャップ**:
- ❌ 車両情報ハッシュ化ロジック
- ❌ アクセス制御実装（modifier）
- ❌ 監査体制

**複雑度シグナル**: 中（標準的なセキュリティパターン）

#### 要件12: パフォーマンス要件

**必要な機能**:
- 査定: 10秒以内
- 自動借入: 3秒以内
- 自動返済: 3秒以内
- 状態更新: 1秒以内

**既存資産**:
- ✅ Base L2（高速ブロック時間：2秒）

**ギャップ**:
- ❌ パフォーマンス測定・最適化

**複雑度シグナル**: 中（外部API速度、ブロックチェーン遅延考慮）

---

## 4. 実装アプローチオプション

### オプションA: 完全オンチェーン（推奨）

**適用範囲**: ローン契約、借入・返済ロジックをすべてスマートコントラクトで実装

**メリット**:
- ✅ 透明性最大（すべてがブロックチェーン上で検証可能）
- ✅ 信頼性高（改ざん不可能）
- ✅ 自動化容易（スマートコントラクトの自動実行）

**デメリット**:
- ❌ ガスコスト高（特に頻繁な金利計算）
- ❌ 開発複雑度高（Solidity制約）
- ❌ 柔軟性低（デプロイ後の変更困難）

**推奨度**: 高（信頼性重視、金利計算最適化で対応）

### オプションB: ハイブリッド

**適用範囲**: コア機能はオンチェーン、補助機能はオフチェーン

**オンチェーン**:
- ローン契約
- 借入・返済トランザクション
- 利用可能枠管理

**オフチェーン（Laravel）**:
- 車両情報保存（詳細データ）
- 査定履歴
- 通知管理
- 金利計算（結果をオンチェーンに反映）

**メリット**:
- ✅ ガスコスト削減
- ✅ 柔軟性高（オフチェーン部分は変更容易）
- ✅ 開発速度向上

**デメリット**:
- ❌ 透明性低下（一部がオフチェーン）
- ❌ 信頼性リスク（オフチェーンの改ざん可能性）
- ❌ 複雑性増加（オンチェーン・オフチェーン同期）

**推奨度**: 中（初期実装の選択肢、将来的に完全オンチェーン化）

### オプションC: 段階的実装（推奨）

**戦略**:
1. **Phase 1 - 基本ローン機能**: オンチェーン中心、手動操作
2. **Phase 2 - 自動化**: 自動借入・返済
3. **Phase 3 - 最適化**: 金利計算最適化、ガスコスト削減

**フェーズ別詳細**:

#### Phase 1: 基本ローン機能（2-3週）
**新規作成**:
- `contracts/VehicleRegistry.sol`: 車両登録
- `contracts/LoanManager.sol`: ローン契約、手動借入・返済
- `pkgs/frontend/app/loan/page.tsx`: ローンダッシュボード
- `laravel/`: 車両情報DB、査定API統合

**手動操作**:
- ユーザーが手動で借入・返済ボタンをクリック

**成果物**: 基本的なローン機能動作（手動）

#### Phase 2: 自動化（2-3週）
**拡張**:
- `contracts/LoanManager.sol`: 自動借入・返済ロジック
- ERC4337 Paymaster統合（オプション）

**自動化**:
- 残高不足時の自動借入
- 入金時の自動返済

**成果物**: 完全自動化ローンシステム

#### Phase 3: 最適化（1-2週）
**最適化**:
- 金利計算のガスコスト削減
- コントラクト監査
- パフォーマンスチューニング

**成果物**: 本番環境デプロイ可能な最適化システム

**リスク軽減**:
- **段階的リリース**: Phase 1で基本価値提供
- **段階的複雑化**: 自動化は後から追加
- **ユーザーフィードバック**: Phase 1でUI/UX改善

**トレードオフ**:
- ✅ リスク分散
- ✅ 早期価値提供
- ✅ 段階的学習
- ❌ Phase間の調整コスト

---

## 5. 実装複雑度とリスク評価

### 5.1 工数見積もり（Effort）

| コンポーネント | サイズ | 根拠 |
|---------------|-------|------|
| VehicleRegistry コントラクト | M (3-7日) | 車両情報管理、アクセス制御 |
| LoanManager コントラクト | L (1-2週) | ローン契約、借入・返済、金利計算 |
| 車両査定API統合 | L (1-2週) | 外部API調査・統合、エラーハンドリング |
| 自動借入・返済ロジック | L (1-2週) | 残高監視、トリガー設計、テスト |
| 金利計算エンジン | M (3-7日) | 固定小数点演算、日割り計算 |
| Laravel 車両情報・査定API | M (3-7日) | CRUD API、DB設計 |
| ローンダッシュボードUI | M (3-7日) | リアルタイム表示、グラフ |
| Web3統合（wagmi） | M (3-7日) | コントラクト読み取り・書き込み |
| 通知システム | M (3-7日) | tipping-featureと統合 |
| セキュリティ・監査 | M (3-7日) | アクセス制御、脆弱性チェック |
| **合計（Phase 1のみ）** | **約5-7週** | 基本機能 |
| **合計（Phase 1-3）** | **約9-13週** | 完全機能 |

**前提条件**: ウォレットアドレス変換機能（ERC4337 SmartAccount）が完成していること

### 5.2 リスク評価

#### 高リスク項目

**1. 車両査定APIの利用可能性と精度**
- **理由**: 日本の車両査定APIが限定的、精度・コスト不明
- **影響**: 機能の根幹、査定精度低下でユーザー不満
- **緩和策**:
  - 複数API調査（カーセンサー、グーネット、ガリバー）
  - AI査定モデル検討（中古車データ学習）
  - ハイブリッド戦略（API + AI補正）
  - 初期: 手動査定（認定買取店連携）でMVP
- **判断**: API調査を最優先実施

**2. 金利計算の正確性とガスコスト**
- **理由**: Solidity浮動小数点演算制約、頻繁な計算でガスコスト高
- **影響**: 金利誤差、運用コスト増大
- **緩和策**:
  - 固定小数点ライブラリ使用（ABDKMath64x64、PRBMath）
  - 日割りではなく月割り計算（精度とガスのバランス）
  - オフチェーン計算 + オンチェーン検証（ハイブリッド）
- **判断**: 固定小数点ライブラリ + 月割り計算を推奨

**3. 自動借入のタイミング制御**
- **理由**: 残高不足検知とトランザクション実行のタイミング
- **影響**: 支払い失敗、ユーザー体験低下
- **緩和策**:
  - ERC4337 Paymaster使用（ガス代支払い時に自動借入）
  - フロントエンドでの事前チェック + 自動借入トリガー
  - ユーザーに事前確認（自動 vs 手動選択可能）
- **判断**: Phase 1は手動、Phase 2でPaymaster検討

**4. 依存機能の完成遅延**
- **理由**: ERC4337 SmartAccountが未実装
- **影響**: ローン契約の紐付け不可
- **緩和策**:
  - wallet-address-conversionチームと密連携
  - モックSmartAccountで先行開発
  - EOA（通常ウォレット）でもサポート（fallback）
- **影響**: プロジェクト全体の遅延

#### 中リスク項目

**5. オンチェーンデータの肥大化**
- **理由**: 車両情報、査定履歴をすべてオンチェーン保存
- **影響**: ガスコスト増大、ストレージコスト
- **緩和策**:
  - 車両情報はハッシュのみオンチェーン（詳細はIPFS or DB）
  - 査定履歴は最新のみオンチェーン
  - イベントログ活用（履歴をイベントで記録）

**6. セキュリティ：ローン契約の改ざんリスク**
- **理由**: スマートコントラクトの脆弱性
- **影響**: 不正借入、資金喪失
- **緩和策**:
  - OpenZeppelin Contractsライブラリ使用
  - 外部監査（Certik、OpenZeppelin等）
  - バグバウンティプログラム
  - 初期: 利用上限設定（被害最小化）

**7. 査定有効期限管理の複雑性**
- **理由**: 30日ごとの再査定、期限切れ時の処理
- **影響**: 有効期限切れローンの扱い
- **緩和策**:
  - 期限切れ時は新規借入停止、返済のみ可能
  - 自動再査定トリガー（オフチェーン）
  - ユーザーへの通知（7日前警告）

#### 低リスク項目

**8. 車両情報入力フォーム**
- **理由**: 標準的なUIコンポーネント
- **緩和策**: 不要
- **影響**: 限定的

**9. ローンダッシュボード表示**
- **理由**: 標準的なダッシュボードUI
- **緩和策**: 不要
- **影響**: 限定的

### 5.3 技術調査項目（設計フェーズで実施）

| 項目 | 目的 | 優先度 |
|------|------|--------|
| 車両査定API調査 | 利用可能API、料金、精度確認 | 高 |
| 固定小数点ライブラリ調査 | 金利計算の正確性確保 | 高 |
| ERC4337 Paymaster学習 | 自動借入実現方法 | 高 |
| AI車両査定モデル調査 | 自前実装の実現可能性 | 中 |
| オンチェーンストレージ最適化 | ガスコスト削減方法 | 中 |
| スマートコントラクト監査手法 | セキュリティ確保方法 | 中 |

---

## 6. 推奨事項と次ステップ

### 6.1 設計フェーズへの推奨事項

#### 優先的に決定すべき事項

**1. 車両査定方法の選定**
- **選択肢**:
  - A. 外部API使用（カーセンサー、グーネット等）
  - B. AI査定モデル（自前学習）
  - C. 手動査定（認定買取店連携、MVP）
  - D. ハイブリッド（API + AI補正）
- **推奨**: C（MVP） → D（本番）
  - MVP: 認定買取店の査定額を手動入力
  - 本番: 外部API + AI補正で自動化

**2. スマートコントラクトアーキテクチャ**
- **決定事項**:
  - オンチェーン vs ハイブリッドの選択
  - 金利計算方式（日割り vs 月割り）
  - データ保存戦略（フルオンチェーン vs ハッシュのみ）
- **推奨**:
  - Phase 1: ハイブリッド（開発速度優先）
  - Phase 3: 完全オンチェーン化（透明性優先）
  - 金利: 月割り計算（ガスコスト削減）
  - データ: ハッシュのみオンチェーン（詳細はIPFS/DB）

**3. 自動借入・返済トリガー設計**
- **選択肢**:
  - A. ERC4337 Paymaster（ガス代支払い時）
  - B. フロントエンド事前チェック + 手動トリガー
  - C. オフチェーン監視サービス + 自動トリガー
- **推奨**: Phase 1はB、Phase 2でAまたはC

**4. 依存機能との調整**
- **決定事項**:
  - ERC4337 SmartAccountのインターフェース確定
  - 実装スケジュール調整
- **推奨**:
  - wallet-address-conversionチームと週次同期
  - SmartAccountのモック早期作成

#### アーキテクチャ図（推奨構成 - Phase 3完全版）

```
┌─────────────────────────────────────────────────────────┐
│                Frontend (Next.js PWA)                    │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │   Vehicle    │  │   Loan       │  │   Appraisal  │  │
│  │   Register   │  │   Dashboard  │  │   Display    │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
│         │                  │                  │         │
│         ▼                  ▼                  ▼         │
│  ┌──────────────────────────────────────────────────┐  │
│  │         wagmi/viem (Web3 Integration)            │  │
│  └──────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────┘
         │                  │                  │
         ▼                  ▼                  ▼
┌──────────────────────────────────────────────────────────┐
│              Base L2 Smart Contracts                     │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │   Vehicle    │  │   Loan       │  │   Interest   │  │
│  │   Registry   │  │   Manager    │  │   Calculator │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
└──────────────────────────────────────────────────────────┘
         │                  │
         ▼                  ▼
┌──────────────┐  ┌──────────────────┐
│  Laravel     │  │  Vehicle         │
│  (Vehicle DB)│  │  Appraisal API   │
│              │  │  (External/AI)   │
└──────────────┘  └──────────────────┘
```

### 6.2 次のステップ

#### 即時実行（設計フェーズ開始前）
1. ✅ ギャップ分析完了
2. ⏭️ `/kiro:spec-design vehicle-value-tokenization` 実行
3. 📋 車両査定API調査開始（最優先）
4. 📋 wallet-address-conversionチームとキックオフ

#### 設計フェーズで実施
1. 車両査定API調査（複数API比較、2-3日）
2. 固定小数点ライブラリ調査（金利計算PoC、1-2日）
3. スマートコントラクト設計（アーキテクチャ図、2日）
4. ERC4337 Paymaster学習（自動借入PoC、2-3日）
5. データモデル・API仕様確定（1日）

#### 実装フェーズ移行判断基準
- ✅ 車両査定方法確定（MVP: 手動査定でOK）
- ✅ スマートコントラクト設計承認
- ✅ 金利計算方式確定
- ✅ 依存機能（ERC4337）の見通し

---

## 7. 付録

### 7.1 参考実装リンク

- [ABDKMath64x64](https://github.com/abdk-consulting/abdk-libraries-solidity) - 固定小数点演算
- [PRBMath](https://github.com/PaulRBerg/prb-math) - 固定小数点・数学ライブラリ
- [ERC4337 Paymaster](https://docs.stackup.sh/docs/paymaster-api) - ガスレス取引
- [OpenZeppelin Ownable](https://docs.openzeppelin.com/contracts/4.x/access-control) - アクセス制御
- [Chainlink Price Feeds](https://docs.chain.link/data-feeds) - JPY/USD為替レート

### 7.2 既存コードベース参照パス

```
car/
├── pkgs/
│   ├── contract/
│   │   ├── contracts/              # スマートコントラクト基盤
│   │   └── hardhat.config.ts       # Base Sepolia設定
│   └── frontend/
│       ├── app/page.tsx            # フロントエンド基盤
│       └── next.config.ts          # PWA設定
└── .kiro/
    ├── specs/
    │   └── wallet-address-conversion/  # 依存機能
    └── steering/                    # プロジェクトコンテキスト
```

### 7.3 車両査定API候補

| API | 提供元 | 料金 | 備考 |
|-----|--------|------|------|
| カーセンサーAPI | リクルート | 調査必要 | 大手、信頼性高 |
| グーネットAPI | プロトコーポレーション | 調査必要 | 中古車情報大手 |
| ガリバーAPI | IDOM | 調査必要 | 買取大手 |
| 自作AI査定 | - | 開発コスト | 学習データ確保が課題 |

### 7.4 用語集

| 用語 | 説明 |
|-----|------|
| 固定小数点演算 | Solidityで浮動小数点を扱うための手法 |
| ABDKMath64x64 | 64.64ビット固定小数点演算ライブラリ |
| ERC4337 Paymaster | ガス代を代理支払いするコントラクト |
| Counterfactual Address | デプロイ前に計算可能なアドレス |
| IPFS | 分散型ファイルストレージ |
| Oracle | オフチェーンデータをオンチェーンに提供するサービス |

---

**作成日**: 2026-01-17  
**分析者**: Claude (Serena AI Agent)  
**ステータス**: 設計フェーズ移行待ち（依存機能・車両査定API調査必須）
